<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Indian Street Sign Converter & Reader</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 2rem;
    background: #f0f0f0;
  }
  h1 {
    text-align: center;
  }
  .container {
    max-width: 600px;
    margin: auto;
    background: white;
    padding: 1rem 2rem 2rem 2rem;
    border-radius: 8px;
    box-shadow: 0 0 10px #ccc;
  }
  input[type="file"] {
    margin-bottom: 1rem;
  }
  button {
    margin: 0.5rem 0.5rem 0.5rem 0;
    padding: 0.5rem 1rem;
    font-size: 1rem;
  }
  #resultText {
    margin-top: 1rem;
    padding: 1rem;
    background: #e8f0fe;
    border-radius: 5px;
    min-height: 50px;
  }
</style>
</head>
<body>
  <div class="container">
    <h1>Indian Street Sign Converter & Reader</h1>

    <h3>1. Convert Image (Street Sign) to Text</h3>
    <input type="file" id="imageInput" accept="image/*" />
    <button id="convertImageBtn">Convert Image to Text</button>

    <h3>2. Voice Input (Speak Street Name)</h3>
    <button id="startVoiceBtn">Start Voice Input</button>
    <button id="stopVoiceBtn" disabled>Stop Voice Input</button>

    <h3>3. Text Output</h3>
    <div id="resultText" contenteditable="true" aria-label="Recognized text will appear here"></div>

    <h3>4. Read Text Aloud</h3>
    <button id="readTextBtn">Read Text</button>
  </div>

  <!-- Tesseract.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.0.2/dist/tesseract.min.js"></script>

  <script>
    const imageInput = document.getElementById('imageInput');
    const convertImageBtn = document.getElementById('convertImageBtn');
    const resultText = document.getElementById('resultText');
    const startVoiceBtn = document.getElementById('startVoiceBtn');
    const stopVoiceBtn = document.getElementById('stopVoiceBtn');
    const readTextBtn = document.getElementById('readTextBtn');

    // OCR: Image to Text
    convertImageBtn.addEventListener('click', () => {
      if (!imageInput.files.length) {
        alert('Please select an image first.');
        return;
      }
      const file = imageInput.files[0];
      const reader = new FileReader();
      reader.onload = function () {
        const img = new Image();
        img.src = reader.result;
        img.onload = () => {
          resultText.textContent = 'Processing image... Please wait.';
          Tesseract.recognize(
            img,
            'eng', // English language, can add 'hin' for Hindi if trained data available
            { logger: m => console.log(m) }
          ).then(({ data: { text } }) => {
            resultText.textContent = text.trim() || 'No text recognized.';
          }).catch(err => {
            resultText.textContent = 'Error recognizing text: ' + err.message;
          });
        };
      };
      reader.readAsDataURL(file);
    });

    // Voice Recognition: Speech to Text
    let recognition;
    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      recognition = new SpeechRecognition();
      recognition.lang = 'en-IN'; // Indian English accent
      recognition.interimResults = false;
      recognition.maxAlternatives = 1;

      recognition.onresult = (event) => {
        const speechResult = event.results[0][0].transcript;
        resultText.textContent = speechResult;
      };

      recognition.onerror = (event) => {
        alert('Speech recognition error: ' + event.error);
      };

      recognition.onend = () => {
        startVoiceBtn.disabled = false;
        stopVoiceBtn.disabled = true;
      };
    } else {
      alert('Speech Recognition API not supported in this browser.');
    }

    startVoiceBtn.addEventListener('click', () => {
      if (recognition) {
        recognition.start();
        startVoiceBtn.disabled = true;
        stopVoiceBtn.disabled = false;
        resultText.textContent = 'Listening...';
      }
    });

    stopVoiceBtn.addEventListener('click', () => {
      if (recognition) {
        recognition.stop();
      }
    });

    // Text to Speech
    readTextBtn.addEventListener('click', () => {
      const text = resultText.textContent.trim();
      if (!text) {
        alert('No text to read.');
        return;
      }
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'en-IN'; // Indian English accent
      speechSynthesis.speak(utterance);
    });
  </script>
</body>
</html>
